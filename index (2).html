<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å±•å…æ‰¿è½½é‡è®¡ç®—å™¨ - æé’°åš v1.0</title>
    
    <!-- iOS / PWA Capable Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ‰¿è½½é‡è®¡ç®—">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0f172a">
    
    <!-- App Icon -->
    <link rel="apple-touch-icon" href="https://picsum.photos/192/192">
    
    <!-- Manifest -->
    <link rel="manifest" href="data:application/manifest+json;base64,eyJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsIm5hbWUiOiLlpJrTn+W6puavlOWIk+i9rOaNouS4k+WbbiIsInNob3J0X25hbWUiOiLavlOWIk+i9rOaNouWbbiIsInN0YXJ0X3VybCI6Ii4iLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzBmMTcyYSIsInRoZW1lX2NvbG9yIjoiIzBmMTcyYSIsImljb25zIjpbeyJzcmMiOiJodHRwczovL3BpY3N1bS5waG90b3MvMTkyLzE5MiIsInNpemVzIjoiMTkyeDE5MiIsInR5cGUiOiJpbWFnZS9wbmcifV19">

    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for in-browser JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              slate: { 850: '#151f32' }
            },
            fontFamily: {
              sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
            },
            spacing: {
              'safe-top': 'env(safe-area-inset-top)',
              'safe-bottom': 'env(safe-area-inset-bottom)',
            }
          }
        }
      }
    </script>

    <style>
        /* Utilities */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        * { -webkit-tap-highlight-color: transparent; }
        body { background-color: #0f172a; color: #f8fafc; overscroll-behavior-y: none; }
        
        .select-none { user-select: none; -webkit-user-select: none; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
</head>
<body class="min-h-screen pb-24 font-sans selection:bg-blue-500 selection:text-white antialiased">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ==========================================
        // CONSTANTS (Converted from Enums)
        // ==========================================

        const ImageRatio = {
            R1_1: "1:1",
            R9_16: "9:16",
            R16_9: "16:9",
            R4_3: "4:3",
            R3_4: "3:4",
            R3_2: "3:2",
            R2_3: "2:3",
            R21_9: "21:9"
        };

        const ScreenRatio = {
            R16_9: "16:9",
            R4_3: "4:3"
        };

        const VenueType = {
            MUSEUM: "museum",
            SCIENCE: "science",
            PLANNING: "planning",
            ENTERPRISE: "enterprise",
            MEMORIAL: "memorial",
            ART: "art",
            THEMATIC: "thematic",
            TEMPORARY: "temporary",
            LIBRARY: "library"
        };

        const CalculationStrategy = {
            QUALITY: "quality",
            TRAFFIC: "traffic"
        };

        const VENUE_DATA = {
            [VenueType.MUSEUM]: {
                name: "åšç‰©é¦†",
                description: "æ–‡ç‰©ç²¾ç»†ï¼Œæ­¥é€Ÿæ…¢",
                coefficientMin: 0.60,
                coefficientMax: 0.75,
                comfortDensityMin: 3.0,
                comfortDensityMax: 4.0,
                peakDensity: 2.0,
                safetyDensity: 1.0,
                stayCoeff: 15
            },
            [VenueType.SCIENCE]: {
                name: "ç§‘æŠ€é¦†",
                description: "äº’åŠ¨ä¸ºä¸»ï¼Œæ“ä½œç©ºé—´",
                coefficientMin: 0.55,
                coefficientMax: 0.65,
                comfortDensityMin: 3.0,
                comfortDensityMax: 4.0,
                peakDensity: 2.0,
                safetyDensity: 1.0,
                stayCoeff: 35
            },
            [VenueType.PLANNING]: {
                name: "è§„åˆ’é¦†",
                description: "è§‚çœ‹å½±ç‰‡æ¶ˆè€—æ—¶é—´",
                coefficientMin: 0.55,
                coefficientMax: 0.65,
                comfortDensityMin: 4.0,
                comfortDensityMax: 4.5,
                peakDensity: 2.5,
                safetyDensity: 1.0,
                stayCoeff: 15
            },
            [VenueType.ENTERPRISE]: {
                name: "ä¼ä¸šé¦†",
                description: "å•†åŠ¡æ¥å¾…ï¼Œä¸“äººå¯¼è§ˆ",
                coefficientMin: 0.70,
                coefficientMax: 0.80,
                comfortDensityMin: 6.0,
                comfortDensityMax: 8.0,
                peakDensity: 4.0,
                safetyDensity: 1.0,
                stayCoeff: 8
            },
            [VenueType.MEMORIAL]: {
                name: "çºªå¿µé¦†",
                description: "åº„é‡æ²‰æµ¸ï¼Œåœºæ™¯å¤åŸ",
                coefficientMin: 0.50,
                coefficientMax: 0.65,
                comfortDensityMin: 4.0,
                comfortDensityMax: 5.0,
                peakDensity: 2.5,
                safetyDensity: 1.0,
                stayCoeff: 30
            },
            [VenueType.ART]: {
                name: "ç¾æœ¯é¦†",
                description: "ä¸­é—´ç©ºæ—·ï¼ŒæŒ‚å¢™å±•ç¤º",
                coefficientMin: 0.75,
                coefficientMax: 0.85,
                comfortDensityMin: 4.0,
                comfortDensityMax: 5.0,
                peakDensity: 2.5,
                safetyDensity: 1.0,
                stayCoeff: 12
            },
            [VenueType.THEMATIC]: {
                name: "ä¸“é¢˜å±•",
                description: "äº¤äº’è®¾å¤‡å¤šï¼Œè€—æ—¶é•¿",
                coefficientMin: 0.45,
                coefficientMax: 0.60,
                comfortDensityMin: 3.0,
                comfortDensityMax: 4.0,
                peakDensity: 2.0,
                safetyDensity: 1.0,
                stayCoeff: 40
            },
            [VenueType.TEMPORARY]: {
                name: "ä¸´å±•å…",
                description: "å¸ƒå±•å¯†åº¦æ³¢åŠ¨å¤§",
                coefficientMin: 0.65,
                coefficientMax: 0.85,
                comfortDensityMin: 2.5,
                comfortDensityMax: 3.5,
                peakDensity: 1.5,
                safetyDensity: 1.0,
                stayCoeff: 15
            },
            [VenueType.LIBRARY]: {
                name: "å›¾ä¹¦é¦†",
                description: "é•¿é©»å‹ï¼Œç¿»å°ç‡ä½",
                coefficientMin: 0.55,
                coefficientMax: 0.70,
                comfortDensityMin: 6.0,
                comfortDensityMax: 8.0,
                peakDensity: 4.0,
                safetyDensity: 1.0,
                stayCoeff: 60
            }
        };

        // ==========================================
        // SHARED COMPONENTS
        // ==========================================

        const InputGroup = ({ label, value, onChange, type = "number", suffix, placeholder }) => {
            return (
                <div className="flex flex-col space-y-1">
                    <label className="text-xs font-medium text-slate-400 uppercase tracking-wider ml-1">
                        {label}
                    </label>
                    <div className="relative">
                        <input
                            type={type}
                            inputMode="decimal"
                            className="w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all shadow-sm"
                            value={value}
                            onChange={(e) => onChange(e.target.value)}
                            placeholder={placeholder}
                        />
                        {suffix && (
                            <span className="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 font-medium">
                                {suffix}
                            </span>
                        )}
                    </div>
                </div>
            );
        };

        const SelectGroup = ({ label, value, onChange, options }) => {
            return (
                <div className="flex flex-col space-y-1">
                    <label className="text-xs font-medium text-slate-400 uppercase tracking-wider ml-1">
                        {label}
                    </label>
                    <div className="relative">
                        <select
                            className="w-full appearance-none bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all shadow-sm"
                            value={value}
                            onChange={(e) => onChange(e.target.value)}
                        >
                            {options.map((opt) => (
                                <option key={opt.value} value={opt.value}>
                                    {opt.label}
                                </option>
                            ))}
                        </select>
                        <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none">
                            <svg className="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                    </div>
                </div>
            );
        };

        const ResultCard = ({ title, value, unit, subtext, highlight = false }) => {
            return (
                <div className={`p-4 rounded-xl border ${highlight ? 'bg-blue-900/20 border-blue-500/30' : 'bg-slate-800 border-slate-700'} flex flex-col items-center justify-center text-center shadow-lg`}>
                    <span className={`text-xs font-bold uppercase tracking-widest mb-1 ${highlight ? 'text-blue-300' : 'text-slate-400'}`}>
                        {title}
                    </span>
                    <div className="flex items-baseline space-x-1">
                        <span className={`text-2xl font-bold ${highlight ? 'text-blue-100' : 'text-white'}`}>
                            {value}
                        </span>
                        {unit && <span className="text-sm text-slate-400 font-medium">{unit}</span>}
                    </div>
                    {subtext && <span className="text-xs text-slate-500 mt-1">{subtext}</span>}
                </div>
            );
        };

        // ==========================================
        // FEATURE: IMAGE RATIO TOOL
        // ==========================================

        const ImageRatioTool = () => {
            const [ratio, setRatio] = useState(ImageRatio.R16_9);
            const [width, setWidth] = useState('1920');
            const [height, setHeight] = useState('1080');
            const [lastEdited, setLastEdited] = useState('width');

            const calculate = (target, val) => {
                const numVal = parseFloat(val);
                if (isNaN(numVal) || numVal === 0) return;

                const parts = ratio.split(':').map(Number);
                const wRatio = parts[0];
                const hRatio = parts[1];
                
                if (target === 'width') {
                    const newHeight = (numVal * hRatio) / wRatio;
                    setHeight(newHeight.toFixed(0));
                } else {
                    const newWidth = (numVal * wRatio) / hRatio;
                    setWidth(newWidth.toFixed(0));
                }
            };

            const handleRatioChange = (newRatio) => {
                setRatio(newRatio);
                const parts = newRatio.split(':').map(Number);
                const wRatio = parts[0];
                const hRatio = parts[1];

                if (lastEdited === 'width') {
                     const currentW = parseFloat(width);
                     if (!isNaN(currentW)) {
                        setHeight(((currentW * hRatio) / wRatio).toFixed(0));
                     }
                } else {
                    const currentH = parseFloat(height);
                    if (!isNaN(currentH)) {
                        setWidth(((currentH * wRatio) / hRatio).toFixed(0));
                    }
                }
            };

            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="bg-slate-800/50 p-4 rounded-2xl border border-slate-700/50">
                        <p className="text-sm text-slate-400 mb-4">è®¾å®šä»»æ„ä¸€è¾¹å°ºå¯¸ï¼Œè‡ªåŠ¨åŒ¹é…å¦ä¸€è¾¹ã€‚</p>
                        <SelectGroup
                            label="é€‰æ‹©æ¯”ä¾‹"
                            value={ratio}
                            onChange={handleRatioChange}
                            options={Object.values(ImageRatio).map(r => ({ value: r, label: r }))}
                        />
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        <InputGroup
                            label="å®½åº¦ (Width)"
                            value={width}
                            onChange={(val) => {
                                setWidth(val);
                                setLastEdited('width');
                                calculate('width', val);
                            }}
                            placeholder="px"
                        />
                        <InputGroup
                            label="é«˜åº¦ (Height)"
                            value={height}
                            onChange={(val) => {
                                setHeight(val);
                                setLastEdited('height');
                                calculate('height', val);
                            }}
                            placeholder="px"
                        />
                    </div>

                    <div className="mt-8 p-6 bg-gradient-to-br from-blue-900/40 to-slate-900/40 border border-blue-500/20 rounded-2xl flex items-center justify-center">
                        <div 
                            className="border-2 border-blue-400 bg-blue-500/10 flex items-center justify-center text-blue-300 font-bold transition-all duration-300"
                            style={{
                                aspectRatio: ratio.replace(':', '/'),
                                width: '100%',
                                maxHeight: '200px',
                                maxWidth: '100%'
                            }}
                        >
                            {ratio}
                        </div>
                    </div>
                </div>
            );
        };

        // ==========================================
        // FEATURE: SCREEN SIZE TOOL
        // ==========================================

        const ScreenSizeTool = () => {
            const [ratio, setRatio] = useState(ScreenRatio.R16_9);
            const [inches, setInches] = useState('55');

            const diagInch = parseFloat(inches) || 0;
            const parts = ratio.split(':').map(Number);
            const wR = parts[0];
            const hR = parts[1];
            
            const theta = Math.atan(hR / wR);
            const widthInch = diagInch * Math.cos(theta);
            const heightInch = diagInch * Math.sin(theta);

            const widthMm = (widthInch * 25.4).toFixed(0);
            const heightMm = (heightInch * 25.4).toFixed(0);

            return (
                <div className="space-y-6 animate-fade-in">
                     <div className="bg-slate-800/50 p-4 rounded-2xl border border-slate-700/50">
                        <p className="text-sm text-slate-400 mb-4">è¾“å…¥å±å¹•å¯¹è§’çº¿å°ºå¯¸ï¼ˆè‹±å¯¸ï¼‰ï¼Œè®¡ç®—å®é™…é•¿å®½ã€‚</p>
                        <div className="grid grid-cols-2 gap-4">
                            <SelectGroup
                                label="å±å¹•æ¯”ä¾‹"
                                value={ratio}
                                onChange={(val) => setRatio(val)}
                                options={[
                                    { value: ScreenRatio.R16_9, label: "16:9 (å®½å±)" },
                                    { value: ScreenRatio.R4_3, label: "4:3 (æ™®å±)" }
                                ]}
                            />
                            <InputGroup
                                label="å°ºå¯¸ (è‹±å¯¸)"
                                value={inches}
                                onChange={setInches}
                                suffix="inch"
                            />
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        <ResultCard
                            title="æ˜¾ç¤ºå®½åº¦"
                            value={widthMm}
                            unit="mm"
                            highlight
                        />
                        <ResultCard
                            title="æ˜¾ç¤ºé«˜åº¦"
                            value={heightMm}
                            unit="mm"
                            highlight
                        />
                    </div>

                     <div className="grid grid-cols-2 gap-4 mt-2">
                        <ResultCard
                            title="å®½åº¦ (m)"
                            value={(parseFloat(widthMm)/1000).toFixed(2)}
                            unit="m"
                        />
                        <ResultCard
                            title="é«˜åº¦ (m)"
                            value={(parseFloat(heightMm)/1000).toFixed(2)}
                            unit="m"
                        />
                    </div>
                    
                    <div className="p-4 rounded-lg bg-yellow-900/20 border border-yellow-700/30 text-xs text-yellow-200/70 text-center">
                        * è®¡ç®—ç»“æœä¸ºå±å¹•æ˜¾ç¤ºåŒºåŸŸå°ºå¯¸ï¼Œä¸å«è¾¹æ¡†ã€‚
                    </div>
                </div>
            );
        };

        // ==========================================
        // FEATURE: CAPACITY TOOL
        // ==========================================

        const CapacityTool = () => {
            const [venueType, setVenueType] = useState(VenueType.MUSEUM);
            const [strategy, setStrategy] = useState(CalculationStrategy.QUALITY);
            const [area, setArea] = useState('1000');
            const [hours, setHours] = useState('8');

            const config = VENUE_DATA[venueType];
            const numArea = parseFloat(area) || 0;
            const numHours = parseFloat(hours) || 0;
            const openMinutes = numHours * 60;

            let effectiveCoeff = 0;
            let effectiveComfortDensity = 0;
            
            if (strategy === CalculationStrategy.QUALITY) {
                effectiveCoeff = config.coefficientMin;
                effectiveComfortDensity = config.comfortDensityMax;
            } else {
                effectiveCoeff = config.coefficientMax;
                effectiveComfortDensity = config.comfortDensityMin;
            }

            const effectiveArea = numArea * effectiveCoeff;

            const optimalCapacity = effectiveComfortDensity > 0 ? Math.floor(effectiveArea / effectiveComfortDensity) : 0;
            const maxCapacity = config.peakDensity > 0 ? Math.floor(effectiveArea / config.peakDensity) : 0;
            const safetyLimit = config.safetyDensity > 0 ? Math.floor(effectiveArea / config.safetyDensity) : 0;

            const formatTime = (mins) => {
                const h = Math.floor(mins / 60);
                const m = Math.round(mins % 60);
                return h > 0 ? `${h}å°æ—¶${m}åˆ†` : `${m}åˆ†é’Ÿ`;
            };

            const calculateAdjustedStay = (baseMinutes) => {
                let t = baseMinutes;
                if (t > 180) {
                    t = 180 + (t - 180) * 0.2;
                }
                if (openMinutes > 0) {
                    t = Math.min(t, openMinutes);
                }
                return t;
            };

            const rawStandardMinutes = (numArea / 100) * config.stayCoeff;
            const stayTimeStandard = calculateAdjustedStay(rawStandardMinutes * 1.0);
            const stayTimeQuick = calculateAdjustedStay(rawStandardMinutes * 0.6);
            const stayTimeHardcore = calculateAdjustedStay(rawStandardMinutes * 1.5);

            const benchmarkStayTime = stayTimeStandard;
            const turnoverRate = benchmarkStayTime > 0 ? (openMinutes / benchmarkStayTime) : 0;

            const recDailyFlow = Math.floor(optimalCapacity * turnoverRate);
            const limitDailyFlow = Math.floor(maxCapacity * turnoverRate);

            return (
                <div className="space-y-6 animate-fade-in pb-20">
                    <div className="space-y-4">
                        <SelectGroup
                            label="å±•é¦†ç±»å‹"
                            value={venueType}
                            onChange={(val) => setVenueType(val)}
                            options={Object.entries(VENUE_DATA).map(([key, data]) => ({
                                value: key,
                                label: data.name
                            }))}
                        />
                        
                        <div className="bg-slate-800/50 px-3 py-2 rounded-lg border border-slate-700/50 text-sm text-slate-400 flex items-start gap-2">
                           <svg className="w-4 h-4 mt-0.5 text-blue-400 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                               <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                           </svg>
                           <span>{config.description}</span>
                        </div>

                        <div className="grid grid-cols-2 gap-4">
                            <InputGroup
                                label="å¸¸è®¾å±•å…é¢ç§¯"
                                value={area}
                                onChange={setArea}
                                suffix="ã¡"
                            />
                            <InputGroup
                                label="å¼€æ”¾æ—¶é•¿"
                                value={hours}
                                onChange={setHours}
                                suffix="å°æ—¶"
                            />
                        </div>

                        <div className="space-y-1">
                            <label className="text-xs font-medium text-slate-400 uppercase tracking-wider ml-1">
                                è®¡ç®—ç­–ç•¥
                            </label>
                            <div className="grid grid-cols-2 p-1 bg-slate-800 rounded-xl border border-slate-700">
                                <button
                                    onClick={() => setStrategy(CalculationStrategy.QUALITY)}
                                    className={`py-2 px-3 rounded-lg text-sm font-bold transition-all ${
                                        strategy === CalculationStrategy.QUALITY 
                                        ? 'bg-blue-600 text-white shadow-lg' 
                                        : 'text-slate-400 hover:text-slate-200'
                                    }`}
                                >
                                    ğŸ›¡ï¸ å®‰å…¨ä¸å“è´¨
                                </button>
                                <button
                                    onClick={() => setStrategy(CalculationStrategy.TRAFFIC)}
                                    className={`py-2 px-3 rounded-lg text-sm font-bold transition-all ${
                                        strategy === CalculationStrategy.TRAFFIC 
                                        ? 'bg-emerald-600 text-white shadow-lg' 
                                        : 'text-slate-400 hover:text-slate-200'
                                    }`}
                                >
                                    ğŸ’° æµé‡ä¸æ”¶ç›Š
                                </button>
                            </div>
                            <p className="text-xs text-slate-500 ml-1">
                                {strategy === CalculationStrategy.QUALITY 
                                    ? "å®½æ¾æ¨¡å¼ï¼šç³»æ•°å–å°ï¼Œäººå‡é¢ç§¯å–å¤§" 
                                    : "ç´§å‡‘æ¨¡å¼ï¼šç³»æ•°å–å¤§ï¼Œäººå‡é¢ç§¯å–å°"}
                            </p>
                        </div>
                    </div>

                    <div className="space-y-4 pt-2">
                        <h3 className="text-sm font-bold text-slate-400 uppercase tracking-wider ml-1 border-b border-slate-800 pb-2">
                            ç¬æ—¶æ‰¿è½½åŠ› (Instant Capacity)
                        </h3>
                        <div className="grid grid-cols-3 gap-3">
                            <div className="col-span-3">
                                <ResultCard
                                    title="æœ€ä½³æ‰¿è½½é‡ (æ¨è)"
                                    value={optimalCapacity.toLocaleString()}
                                    unit="äºº"
                                    highlight={true}
                                    subtext="ä¿è¯ä½“éªŒçš„ç†æƒ³äººæ•°"
                                />
                            </div>
                            <ResultCard
                                title="æœ€å¤§æ‰¿è½½é‡"
                                value={maxCapacity.toLocaleString()}
                                unit="äºº"
                                subtext="æ‹¥æŒ¤çŠ¶æ€"
                            />
                            <div className="col-span-2">
                                <ResultCard
                                    title="å®‰å…¨ä¸Šé™ (çº¢çº¿)"
                                    value={safetyLimit.toLocaleString()}
                                    unit="äºº"
                                    subtext="æ¶ˆé˜²åº”æ€¥æé™"
                                />
                            </div>
                        </div>

                        <h3 className="text-sm font-bold text-slate-400 uppercase tracking-wider ml-1 border-b border-slate-800 pb-2 pt-2">
                            æ—¥å‡æµé‡ä¸å‘¨è½¬ (Daily Flow)
                        </h3>
                        <div className="grid grid-cols-3 gap-3">
                            <ResultCard
                                title="ç¿»å°ç‡"
                                value={turnoverRate.toFixed(1)}
                                unit="æ¬¡/æ—¥"
                            />
                            <div className="col-span-2">
                                <ResultCard
                                    title="æ¨èæ—¥æµé‡"
                                    value={recDailyFlow.toLocaleString()}
                                    unit="äºº/å¤©"
                                    highlight={true}
                                />
                            </div>
                            <div className="col-span-3">
                                <ResultCard
                                    title="æé™æ—¥æµé‡"
                                    value={limitDailyFlow.toLocaleString()}
                                    unit="äºº/å¤©"
                                    subtext="æ»¡è´Ÿè·è¿è½¬ä¸‹çš„æœ€å¤§æ¥å¾…èƒ½åŠ›"
                                />
                            </div>
                        </div>

                         <h3 className="text-sm font-bold text-slate-400 uppercase tracking-wider ml-1 border-b border-slate-800 pb-2 pt-2">
                            åœç•™æ—¶é•¿æ¨¡å‹ (Stay Duration)
                        </h3>
                        <div className="bg-slate-800 border border-slate-700 rounded-xl p-4 space-y-3">
                            <div className="flex justify-between items-center pb-2 border-b border-slate-700/50">
                                <span className="text-slate-400 text-sm">æ·±åº¦ä½“éªŒ (åŸºå‡†)</span>
                                <span className="text-xl font-bold text-blue-100">{formatTime(stayTimeStandard)}</span>
                            </div>
                             <div className="flex justify-between items-center text-sm">
                                <span className="text-slate-500">èµ°é©¬è§‚èŠ± (0.6x)</span>
                                <span className="text-slate-300">{formatTime(stayTimeQuick)}</span>
                            </div>
                             <div className="flex justify-between items-center text-sm">
                                <span className="text-slate-500">ç¡¬æ ¸å­¦ä¹  (1.5x)</span>
                                <span className="text-slate-300">{formatTime(stayTimeHardcore)}</span>
                            </div>
                            {(rawStandardMinutes > 180) && (
                                <p className="text-[10px] text-yellow-500/80 pt-1">
                                    *å·²è§¦å‘ç–²åŠ³ä¿®æ­£æ¨¡å‹ï¼šè¶…è¿‡3å°æ—¶åï¼Œæ¨¡æ‹Ÿè§‚ä¼—ç–²åŠ³å¯¼è‡´æµè§ˆé€Ÿåº¦åŠ å¿«ã€‚
                                </p>
                            )}
                             {(stayTimeStandard >= openMinutes) && (
                                <p className="text-[10px] text-red-400/80 pt-1">
                                    *æ—¶é•¿å·²å—é™äºå¼€é¦†æ—¶é—´ ({hours}h)ã€‚
                                </p>
                            )}
                        </div>
                    </div>

                     <div className="mt-4 p-4 rounded-xl bg-slate-800/50 border border-slate-700/50 text-[10px] text-slate-500 space-y-1">
                        <div className="flex justify-between">
                            <span>è®¡ç®—ç­–ç•¥:</span>
                            <span className="text-slate-400">{strategy === CalculationStrategy.QUALITY ? 'å®‰å…¨ä¸å“è´¨' : 'æµé‡ä¸æ”¶ç›Š'}</span>
                        </div>
                        <div className="flex justify-between">
                            <span>æœ‰æ•ˆé¢ç§¯ç³»æ•°:</span>
                            <span className="font-mono text-slate-300">{effectiveCoeff.toFixed(2)}</span>
                        </div>
                        <div className="flex justify-between">
                            <span>èˆ’é€‚äººå‡æŒ‡æ ‡:</span>
                            <span className="font-mono text-slate-300">{effectiveComfortDensity.toFixed(1)} ã¡/äºº</span>
                        </div>
                         <div className="flex justify-between">
                            <span>å•ä½åœç•™ç³»æ•°:</span>
                            <span className="font-mono text-slate-300">{config.stayCoeff} min/100ã¡</span>
                        </div>
                    </div>
                </div>
            );
        };

        // ==========================================
        // MAIN APP COMPONENT
        // ==========================================

        const Tab = {
            CAPACITY: 'capacity',
            IMAGE: 'image',
            SCREEN: 'screen'
        };

        const IconImage = () => (
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" strokeWidth="2"/>
                <circle cx="8.5" cy="8.5" r="1.5" strokeWidth="2"/>
                <path d="M21 15l-5-5L5 21" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
            </svg>
        );

        const IconScreen = () => (
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2" strokeWidth="2"/>
                <line x1="8" y1="21" x2="16" y2="21" strokeWidth="2" strokeLinecap="round"/>
                <line x1="12" y1="17" x2="12" y2="21" strokeWidth="2" strokeLinecap="round"/>
            </svg>
        );

        const IconCapacity = () => (
            <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
        );

        const App = () => {
            const [activeTab, setActiveTab] = useState(Tab.CAPACITY);

            const renderContent = () => {
                switch (activeTab) {
                    case Tab.CAPACITY: return <CapacityTool />;
                    case Tab.IMAGE: return <ImageRatioTool />;
                    case Tab.SCREEN: return <ScreenSizeTool />;
                }
            };

            const getTitle = () => {
                switch (activeTab) {
                    case Tab.CAPACITY: return "å±•å…æ‰¿è½½é‡";
                    case Tab.IMAGE: return "å›¾ç‰‡æ¯”ä¾‹æ¢ç®—";
                    case Tab.SCREEN: return "å±å¹•å°ºå¯¸è®¡ç®—";
                }
            };

            return (
                <div className="min-h-screen bg-slate-900 text-slate-50 font-sans selection:bg-blue-500 selection:text-white pb-24">
                    {/* Header - Sticky */}
                    <header className="sticky top-0 z-50 bg-slate-900/80 backdrop-blur-md border-b border-slate-800 pt-safe-top">
                        <div className="max-w-md mx-auto px-6 py-4 flex items-center justify-between">
                            <h1 className="text-xl font-bold bg-gradient-to-r from-blue-400 to-indigo-400 bg-clip-text text-transparent">
                                {getTitle()}
                            </h1>
                            <div className="text-xs font-mono text-slate-500">æé’°åš-v1.0</div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-md mx-auto px-6 py-6">
                        {renderContent()}
                    </main>

                    {/* Bottom Navigation - Fixed */}
                    <nav className="fixed bottom-0 left-0 right-0 bg-slate-850 border-t border-slate-800 pb-safe-bottom z-50">
                        <div className="max-w-md mx-auto flex justify-around items-center px-2 py-2">
                            <button 
                                onClick={() => setActiveTab(Tab.CAPACITY)}
                                className={`flex flex-col items-center p-3 rounded-2xl w-full transition-all duration-200 select-none ${activeTab === Tab.CAPACITY ? 'text-blue-400 bg-slate-800' : 'text-slate-500 active:scale-95'}`}
                            >
                                <IconCapacity />
                                <span className="text-[10px] mt-1 font-medium">æ‰¿è½½é‡</span>
                            </button>

                            <button 
                                onClick={() => setActiveTab(Tab.IMAGE)}
                                className={`flex flex-col items-center p-3 rounded-2xl w-full transition-all duration-200 select-none ${activeTab === Tab.IMAGE ? 'text-blue-400 bg-slate-800' : 'text-slate-500 active:scale-95'}`}
                            >
                                <IconImage />
                                <span className="text-[10px] mt-1 font-medium">æ¯”ä¾‹</span>
                            </button>

                            <button 
                                onClick={() => setActiveTab(Tab.SCREEN)}
                                className={`flex flex-col items-center p-3 rounded-2xl w-full transition-all duration-200 select-none ${activeTab === Tab.SCREEN ? 'text-blue-400 bg-slate-800' : 'text-slate-500 active:scale-95'}`}
                            >
                                <IconScreen />
                                <span className="text-[10px] mt-1 font-medium">å±å¹•</span>
                            </button>
                        </div>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>